# CryptoQuant 快速开始指南

欢迎使用 CryptoQuant 加密货币量化回测框架！本指南将帮助你在 5 分钟内完成第一次回测。

## 📋 前置要求

- Python 3.8+
- 网络连接（用于下载数据）

## 🚀 快速开始三步曲

### 第一步：安装依赖

在项目根目录执行：

```bash
# 方式 1：使用 pip install -e （推荐）
pip install -e .

# 方式 2：手动安装核心依赖
pip install backtrader fastapi uvicorn pandas numpy ccxt talib-binary seaborn
```

### 第二步：下载数据

运行数据下载脚本：

```bash
python script/get_btcusdt_data.py
```

**注意事项：**
- 默认下载 2025-06-20 到 2025-12-31 的 5 分钟级别数据
- 如需修改时间范围，编辑 `script/get_btcusdt_data.py` 中的 `START_DATE` 和 `END_DATE`
- 如果使用代理，请在脚本中配置 `PROXIES` 参数
- 数据将保存到 `data/btc-usdt-5m.csv`

### 第三步：运行回测

```bash
python script/run_backtest.py
```

回测完成后，你将看到：

1. **终端输出**：
   ```
   ============================================================
   BTC/USDT RSI 策略回测
   ============================================================
   数据文件: E:\...\btc-usdt-5m.csv
   时间周期: 5 分钟
   数据行数: 56160, 设置图表最大显示: 61776
   ============================================================
   初始资金: 10000.00 USDT
   ============================================================
   Web server is running at http://127.0.0.1:8765
   期末资金: 8796.89 USDT
   收益: -1203.11 USDT (-12.03%)
   ============================================================
   回测完成！报告已生成在 ./reports 目录
   ============================================================
   ```

2. **实时图表**：浏览器自动打开 `http://127.0.0.1:8765`
   - 🌙 **夜间模式**：深色主题，保护眼睛
   - 📊 **K线图**：完整的蜡烛图，带有买卖信号标记
   - 📈 **成交量图**：独立显示，不遮挡K线
   - 🎮 **播放控制**（左下角）：
     - `Playback`：切换逐根播放模式
     - `Play/Pause`：控制播放/暂停
     - `Speed`：调整播放速度（Fast/Medium/Slow）

3. **静态报告**：`reports/` 目录下生成 PNG 和 TXT 格式报告

## 🎯 查看回测结果

### 实时图表功能

访问 `http://127.0.0.1:8765` 后，你可以：

1. **缩放图表**：
   - 鼠标滚轮：放大/缩小
   - 鼠标拖拽：平移时间轴
   - 双击：重置视图

2. **查看信号**：
   - 🔵 青色向上箭头：买入信号（Buy）
   - 🟣 紫色向下箭头：卖出信号（Sell）
   - 🟡 黄色方块：平仓信号（Close）

3. **逐根播放**（可选）：
   - 点击左下角 `Playback` 复选框启用
   - 点击 `Play` 开始逐根动画
   - 通过 `Speed` 下拉菜单调整速度

### 退出程序

回测完成后，程序会保持运行以便查看图表。

**退出方式**：按 `Ctrl+C`

```
浏览器打开地址: http://127.0.0.1:8765
按 Ctrl+C 退出
============================================================
^C
服务器已关闭
```

## 🔧 自定义配置

### 修改策略参数

编辑 `script/run_backtest.py`：

```python
strategy_params = {
    'rsi_period': 14,       # RSI 周期（默认 14）
    'rsi_oversold': 30,     # 超卖线（买入阈值）
    'rsi_overbought': 70,   # 超买线（卖出阈值）
    'printlog': False,      # 是否打印详细日志
}
```

### 修改回测参数

```python
results = quick_backtest(
    csv_path=data_path,
    strategy_class=RSIBacktraderStrategy,
    strategy_params=strategy_params,
    initial_cash=10000.0,      # 初始资金
    commission=0.0004,          # 手续费率（0.04%）
    output_dir=str(project_root / "reports"),
    strategy_name="BTC_RSI_5m"
)
```

## 📚 下一步

- 📖 [数据下载详细指南](./02-数据下载指南.md)
- 🎯 [回测框架使用手册](./03-回测框架手册.md)
- 🧠 [策略开发教程](./04-策略开发教程.md)
- 🔬 [进阶功能与最佳实践](./05-进阶功能.md)

## ❓ 常见问题

**Q1: 图表不显示怎么办？**
- 检查终端是否显示 "Web server is running at http://127.0.0.1:8765"
- 手动访问 http://127.0.0.1:8765
- 检查是否有其他程序占用 8765 端口
- 清空浏览器缓存（Ctrl+Shift+Delete）

**Q2: 按 Ctrl+C 后终端卡住怎么办？**
- 已在最新版本修复，服务器线程会自动退出
- 如果仍然卡住，再按一次 Ctrl+C 强制终止

**Q3: 回测数据不完整？**
- 确保回测完成后等待 2 秒（自动延迟），让前端获取最后的数据
- 刷新浏览器页面（F5）

**Q4: 如何下载更多数据？**
- 编辑 `script/get_btcusdt_data.py`
- 修改 `START_DATE` 和 `END_DATE`
- 修改 `TIMEFRAME_CONFIG` 添加更多时间周期

---

🎉 恭喜！你已经完成了第一次回测。现在开始探索更多功能吧！
